# 1. 权衡的艺术
## 1.1 命令式和声明式
* 命令式关注过程——jQuery
* 声明式关注结果——vuejs
## 1.2 性能与可维护性的权衡
声明式的代码性能不优于命令式代码的性能。    
```
命令式代码性能消耗 = 直接修改的性能消耗
声明式代码性能消耗 = 找出差异的性能消耗 + 直接修改的性能消耗
```
## 1.3 虚拟DOM的性能
DOM层面的计算远比JavaScript层面的计算性能差。
```
// 创建页面二者差距不大
innerHtml创建页面的性能 = HTML字符串拼接的计算量 + innerHTML的DOM计算量
虚拟DOM创建页面的性能 = 创建JavaScript的计算量 + 创建真实DOM的计算量
```
```
// 虚拟DOM性能更好

innerHtml更新页面的性能 = 重新构建HTML字符串的计算量 + 销毁所有旧DOM + 新建所有新DOM // 性能与数据变化相关

虚拟DOM更新页面的性能 = 创建新的JavaScript对象 + Diff + 必要的DOM更新 // 性能与模版大小相关
```
|  innerHtml(模板)  | 虚拟DOM  | 原生JavaScript  |
|  ---------------  | ------- |--------------  |
| 心智负担中等  | 心智负担小 | 心智负担大 |
| 可维护性一般  | 可维护性强 | 可维护性差 |
| 性能差  | 性能不错 | 性能高 |

## 1.4 运行时和编译时
* 纯运行时的框架——提供Render函数将数据渲染为DOM元素
* 运行时+编译时——Compiler把HTML标签编译为树形结构的数据对象+Render将数据渲染为DOM元素
* 纯编译时的框架——提供Compiler把HTML编译为命令式代码

# 2. 框架设计的核心要素
框架设计需要考虑的问题。
1. 框架应该给用户提供哪些构建产物？
2. 产物的模块格式是什么？
3. 如何打印合适的警告信息，让用户快速定位问题？
4. 开发版本和生产版本的构建有什么区别？
5. 热更新是否需要框架层面的支持？
6. 用户能否选择关闭框架的某些功能从而减少资源打包的体积？

## 2.1 提升用户的开发体验
1. warn
2. initCustomFormatter
## 2.2 控制框架代码的体积
1. 只在开发环境打印警告
## 2.3 框架要做到良好的 Tree-Shaking
1. Tree-Shaking 消除那些永远不会被执行的代码。
2. 必须是ESM 模块才能使用 Tree-Shaking.

副作用：
1. 副作用就是，当调用函数的时候，会对外部产生影响，例如修改了全局变量
2. 
```
/*__PURE__*/ 可以注释调用时不会产生副作用的代码。
一般都是在顶级调用的函数和上使用
``` 

## 2.4 框架应该输出怎样的构建产物
1. script 标签引入，需要打包IIFE资源
